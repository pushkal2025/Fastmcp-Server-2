# # worker_processes 1;

# # events { worker_connections 1024; }

# # http {
# #   include       /etc/nginx/mime.types;
# #   default_type  application/octet-stream;
# #   sendfile        on;

# #   upstream fastmcp_api {
# #   server 127.0.0.1:8080;  # must match Render's PORT env
# # }


# #   upstream jira_api {
# #     server 127.0.0.1:8000;
# #   }

# #   server {
# #     listen 80;

# #     # /api → MCP (server.py)
# #     location /api/ {
# #     proxy_pass         http://fastmcp_api/mcp/;  # ← add /mcp/ here
# #     proxy_set_header   Host $host;
# #     proxy_set_header   X-Real-IP $remote_addr;
# #     proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
# #     }

# #     # /jira → Jira MCP
# #     location /jira/ {
# #       proxy_pass         http://jira_api/mcp/;
# #       proxy_set_header   Host $host;
# #       proxy_set_header   X-Real-IP $remote_addr;
# #       proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
# #     }
# #     location /health {
# #       proxy_pass         http://fastmcp_api/health;
# #       proxy_set_header   Host $host;
# #       proxy_set_header   X-Real-IP $remote_addr;
# #       proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
# #     }
# #   }
# # }


# worker_processes 1;

# events { worker_connections 1024; }

# http {
#   include       /etc/nginx/mime.types;
#   default_type  application/octet-stream;
#   sendfile        on;

#   # Add general proxy timeouts for all proxied connections
#   proxy_read_timeout 300s;  # Increased read timeout
#   proxy_send_timeout 300s;  # Increased send timeout
#   proxy_connect_timeout 75s; # Increased connection timeout

#   upstream fastmcp_api {
#   server 127.0.0.1:8080;
# }


#   upstream jira_api {
#     server 127.0.0.1:8000;
#   }

#   server {
#     listen 80;

#     # /api → MCP (server.py)
#     location /api {
#       proxy_pass         http://fastmcp_api/mcp/;
#       proxy_set_header   Host $host;
#       proxy_set_header   X-Real-IP $remote_addr;
#       proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
      
#       # *** ESSENTIAL FOR STREAMING/WEBSOCKET-LIKE CONNECTIONS ***
#       proxy_http_version 1.1;
#       proxy_set_header Upgrade $http_upgrade;
#       proxy_set_header Connection "upgrade";
#     }

#     # /jira → Jira MCP
#     location /jira {
#       proxy_pass         http://jira_api/mcp/;
#       proxy_set_header   Host $host;
#       proxy_set_header   X-Real-IP $remote_addr;
#       proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
      
#       # *** ESSENTIAL FOR STREAMING/WEBSOCKET-LIKE CONNECTIONS ***
#       proxy_http_version 1.1;
#       proxy_set_header Upgrade $http_upgrade;
#       proxy_set_header Connection "upgrade";
#     }

#     location /health {
#       proxy_pass         http://fastmcp_api/health;
#       proxy_set_header   Host $host;
#       proxy_set_header   X-Real-IP $remote_addr;
#       proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
#     }
#   }
# }